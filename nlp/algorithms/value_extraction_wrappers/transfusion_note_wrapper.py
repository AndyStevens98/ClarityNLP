from algorithms.value_extraction.columbia_transfusion_note_reader import run_note_reader
import json


def run_transfusion_finder_full(text: str):
    json_string = run_note_reader(text)
    res = json.loads(json_string)

    return res


if __name__ == "__main__":
    result = run_transfusion_finder_full("Transfusion Note:\n\nBlood Products Ordered:\n\nBlood Product Ordered:        Packed Red Blood Cells        \nConsent verified and present in chart        Yes        \nDonor Number:        W050505050505        \nAdditional criteria ordered and verified against blood bag tag and label:        Leuko Reduced        \n\nPre-Transfusion Assessment:\n\nMD/NP/PA Order:        Blood component delivered matches MD/NP/PA order        \nPretransfusion Medications:        None Ordered        \n\nTwo Person-Three Way Check:\n\nCorrect Patient Identity: Verified patient MR#, last and first name and verbal spelling of name. Correct Blood Component: Donor# on blood bag to donor# on cross match and transfusion form/tag (see co-signature).        Verified        \n\nBlood Warmer Used:        N/A        \n\nTransfusion Start:\n\nTransfusion Start Date/Time:        12-Dec-1905 09:45        \n\nVital Signs Flowsheet:\n\n1) Vital Signs Flowsheet (ICU):\n\nDate/Time        12-Dec-1905 09:45        12-Dec-1905 10:00        12-Dec-1905 10:45        \nDry Weight (kg) Dry Weight (kg)        83.8        83.8        83.8        \nHeight Height (cm)        179.3        179.3        179.3        \nTemperature (C) degrees C        37.9        37.9        38        \nTemperature Source        Core Temp: PA Catheter        Core Temp: PA Catheter        Core Temp: PA Catheter        \nMonitor        BLOODT        BLOODT        BLOODT        \nHeart Rate        90        90        90        \nRhythm         Paced        Paced        Paced        \nRespiratory Rate, Machine Respiratory Rate, Machine (bpm)        0        0        0        \nRespiratory Rate, Patient (bpm) Respiratory Rate, Patient (bpm)        23        16        14        \nSpO2 (Pulse Ox) SpO2 (Pulse Ox) (%)                100        100        \nArterial Systolic        141        117        127        \nArterial Diastolic        60        54        61        \nArterial Mean        87        75        83        \nBlood Glucose Monitor mg/dl ref range 74-118 mg/dl                145                \nNorepinephrine DRIP          ml/hr:         7.5\n\nmicrogram/min:         2         ml/hr:         0\n\nmicrogram/min:         0         ml/hr:         0\n\nmicrogram/min:         0        \nVasopressin DRIP          ml/hr:         2\n\nUNIT/hr:         2         ml/hr:         2\n\nUNIT/hr:         2         ml/hr:         2\n\nUNIT/hr:         2        \nAmiodarone DRIP          ml/hr:         33.33\n\nmg/min:         1         ml/hr:         33.33\n\nmg/min:         1         ml/hr:         33.33\n\nmg/min:         1        \nInsulin DRIP          ml/hr:         1\n\nUNIT/hr:         1         ml/hr:         1.5\n\nUNIT/hr:         1.5         ml/hr:         1.5\n\nUNIT/hr:         1.5        \nPropofol +R DRIP          ml/hr:         0\n\nmicrogram/kg/min:         0         ml/hr:         0\n\nmicrogram/kg/min:         0         ml/hr:         0\n\nmicrogram/kg/min:         0        \nPAP (S) Systolic        40        36        40        \nPAP (D) Diastolic        20        21        23        \nPAP (M) mean        26        26        28        \nCVP mmHg        15        15                \nActivity                 Bed rest                \nPositioning                 HOB 30 degrees; Turned/positioned; Left side                \nRASS Sedation Scale (ICU only)                -1 Drowsy                \n\nTransfusion End:\n\nTransfusion End Date/Time:        12-Dec-1905 10:45        \n\nPost-Transfusion Assessment:\n\nTransfusion Reaction (if yes, complete next section):        No        \n\nPatient Education - Transfusion:\n\nLearner        Patient Family member (specify below)        \nBarriers To Learning        Barriers identified, education adapted        \nBarriers Reason        Physical and / or Sensory Impairment        \nTransfusion Potential Reaction(s)        Chills. Fever. Urticaria. Nausea/vomiting. Backache. Difficult Breathing        \nMethod Used:        Verbal Discussion        \nEvaluation:        Unable to perform skills safely and effectively. Unable to explain. Needs further education (Specify Topic below)        \n")
    print(result)
